import{f as e,r as l,v as n,g as o,q as a,K as t,o as r,Z as s,i,w as u,a as d,J as c,c as v,B as m,b as p,F as _,D as h,aE as b,N as f,s as k,H as g,d as y,C as x,t as w,G as $,ad as C,a2 as S,bf as P,cU as F,I as N,R as M,Q as A,a0 as T,dc as D,dd as I,df as B,b0 as R,cr as E,bP as Y,O as L,cM as O,bN as W,m as G,dg as H,dh as V,M as U,$ as q,a8 as z,_ as j,aa as K,cq as J,bG as X,y as Q,ay as Z,cf as ee,di as le,dj as ne,dk as oe,dl as ae,ak as te,z as re,dm as se,dn as ie,dp as ue,dq as de,dr as ce,bI as ve,V as me,ds as pe,dt as _e,du as he,dv as be,cT as fe,a3 as ke,dw as ge,al as ye,dx as xe,x as we,cL as $e,bp as Ce,P as Se,dy as Pe,b1 as Fe,n as Ne,a4 as Me,U as Ae,bg as Te,dz as De,dA as Ie,dB as Be,c_ as Re}from"./CcL3nfnm.js";import{u as Ee}from"./Dewn7Ah1.js";const Ye={class:"flex mt-4px"},Le=e({__name:"collect",props:{iconClass:{},isCollected:{type:Boolean},userFavoriteGroups:{}},emits:["collect","newGroupAndCollect"],setup(e,{emit:P}){const F=e,N=P,M=l(0),A=l(""),T=l(!1),D=l(!1),I=l(!1),{t:B}=n(),R=o((()=>[{name:B("defaultGroup"),group_id:0}].concat(F.userFavoriteGroups)));function E(){C()&&(F.isCollected?N("collect"):D.value=!0)}const Y=()=>{if(A.value){if(R.value.find((e=>e.name===A.value)))return void S.error(B("groupNameAlreadyExists"));N("newGroupAndCollect",A.value)}else N("collect",M.value);L()};function L(){D.value=!1,A.value="",T.value=!1}return document.addEventListener("click",L),a((()=>{document.removeEventListener("click",L)})),(e,l)=>{const n=x,o=b,a=f,C=g,S=s;return r(),t(S,{"popper-class":"[&&]:[--el-popover-padding:0]",visible:i(D),trigger:"click",width:"248px"},{reference:u((()=>[p(n,{name:"custom:star",class:$(`${e.iconClass} ${e.isCollected?"color-[--yellow]":"color-[--icon-color]"}`),onClick:c(E,["self","stop"])},null,8,["class"])])),default:u((()=>[d("div",{class:"flex flex-col gap-8px p-12px",onClick:l[2]||(l[2]=c((()=>{}),["stop"]))},[(r(!0),v(_,null,h(i(R),(e=>(r(),v("div",{key:e.group_id},[p(o,{class:"[--el-checkbox-height:14px]",label:e.name,modelValue:i(M)===e.group_id,onChange:l=>{return n=e.group_id,M.value=n,void(A.value="");var n}},null,8,["label","modelValue","onChange"])])))),128)),i(T)?(r(),t(a,{key:0,modelValue:i(A),"onUpdate:modelValue":l[0]||(l[0]=e=>k(A)?A.value=e:null),modelModifiers:{trim:!0},clearable:"",placeholder:e.$t("enterGroupName"),maxlength:20},null,8,["modelValue","placeholder"])):m("",!0),p(C,{disabled:i(T),class:"w-full",onClick:l[1]||(l[1]=e=>T.value=!0)},{default:u((()=>[p(n,{name:"material-symbols:add-circle",class:"mr-4px"}),y(w(e.$t("newGroup")),1)])),_:1},8,["disabled"]),d("div",Ye,[p(C,{class:"flex-1",onClick:L},{default:u((()=>[y(w(e.$t("cancel")),1)])),_:1}),p(C,{loading:i(I),class:"flex-1",type:"primary",onClick:Y},{default:u((()=>[y(w(e.$t("confirm")),1)])),_:1},8,["loading"])])])])),_:1},8,["visible"])}}});function Oe(e,l){const{$api:n}=P();return n(`/v1api/v2/tokens/${e}/vote/support`,{method:"post",body:{user_address:l}})}function We(e,l){const{$api:n}=P();return n(`/v1api/v2/tokens/${e}/vote/against`,{method:"post",body:{user_address:l}})}function Ge(e,l){const{$api:n}=P();return n("/v1api/v2/tokens/contract/vote",{method:"get",query:{token_id:e,user_address:l}})}function He(e){const{$api:l}=P();return l("/v1api/v2/tokens/lp_holders",{method:"get",query:{token_id:e}})}const Ve=F("check",(()=>{const e=l(null),n=N(!1),o=N(0),a=N(!1),t=N(0),r=N(0),s=N(0);function i(e){return(null==e?void 0:e.lock)||/lock|null|(black hole)/gi.test((null==e?void 0:e.mark)||"")}return{hasLpLock:a,progress:o,showResult:n,checkResult:e,statistics_risk_store:t,statistics_warning_store:r,statistics_unknown_store:s,getContractCheckResult:function(l,t){(function(e,l){const{$api:n}=P();return n("/v1api/v2/tokens/contract",{method:"get",query:{token_id:e,type:"token",user_address:l}})})(l,t).then((l=>{var t,r,s,u,d,c,v,m,p,_;const h=l.token_contract,b=null==(t=null==h?void 0:h.contract_data)?void 0:t.audits_info;let f=null;b&&(f=JSON.parse(b));const k=(null==(s=null==(r=null==h?void 0:h.contract_data)?void 0:r.owner_txs)?void 0:s.filter((e=>{var l;return(null==e?void 0:e.params)&&(null==(l=null==e?void 0:e.params)?void 0:l.length)>0})))||[];null!==h.contract_data&&(n.value=!0);const g=((null==(u=h.contract_data)?void 0:u.pair_holders_rank)||[]).reduce(((e,l)=>{let n=0;return i(l)&&(n=Number(null==l?void 0:l.quantity)),e+n}),0)/Number(null==(d=null==h?void 0:h.contract_data)?void 0:d.pair_total);a.value=(null==(c=null==h?void 0:h.contract_data)?void 0:c.is_locked)||(((null==(p=null==(m=null==(v=null==h?void 0:h.contract_data)?void 0:v.pair_holders_rank)?void 0:m.some)?void 0:p.call(m,(e=>i(e))))&&g>.001)??!1),o.value=((null==(_=null==h?void 0:h.contract_data)?void 0:_.risk_score)??0)/100||0;const y={...null==h?void 0:h.contract_data,...h,audits_info:f,owner_txs:k};e.value=y}))}}})),Ue=F("rankKline",(()=>{const e=l({}),a=l(null),t=l(null),r=N([]),s=l(!1),i=l(""),u=l(""),d=l(0),c=l(0),v=l(0),m=l(!1),p=l(!1),_=M(),h=A(),{t:b}=n(),f=N(0),k=o((()=>{var e;return f.value||(null==(e=y.value)?void 0:e.current_price_usd)})),g=o((()=>h.evmAddress||_.address)),y=o((()=>{var e;return null==(e=a.value)?void 0:e.token})),x=o((()=>{var e,l;return null==(l=null==(e=a.value)?void 0:e.pairs)?void 0:l[0]})),w=o((()=>{var e,l;return 0==d.value?b("defaultGroup"):null==(l=null==(e=r.value)?void 0:e.find((e=>e.group_id==d.value)))?void 0:l.name})),$=o((()=>{var e;return null==(e=x.value)?void 0:e.pair})),C=o((()=>{var e,l,n,o;const a=new T((null==(e=y.value)?void 0:e.total)||0).minus((null==(l=y.value)?void 0:l.lock_amount_dec)||0).minus((null==(n=y.value)?void 0:n.other_amount_dec)||0).minus((null==(o=y.value)?void 0:o.burn_amount_dec)||0);return a.lt(0)?new T(0):a})),S=o((()=>new T(k.value||0).times(C.value||0).toFixed()||"0"));return{klineRow:e,tokenInfo:a,tokenInfoExtra:t,userFavoriteGroups:r,collected:s,remark:i,remark2:u,groupId:d,selectedGroup:v,token:y,pair:x,twitterType:c,currentGroup:w,editableGroup:m,editableRemark:p,pairAddress:$,tokenPrice:f,price:k,circulation:C,marketCap:S,getData:function(e){const l=e.id;D(l).then((e=>{a.value=e})),I(l).then((e=>{t.value=e})),function(e){B(e).then((e=>{c.value=e.type||0})).catch((()=>{c.value=0}))}(l),g.value&&(function(e){E(e,g.value).then((e=>{s.value=!!(null==e?void 0:e.address),i.value=(null==e?void 0:e.remark)||"",u.value=(null==e?void 0:e.remark)||"",d.value=(null==e?void 0:e.group_id)||0,v.value=(null==e?void 0:e.group_id)||0})).catch((e=>{})).finally((()=>{}))}(l),async function(){try{const e=await R(g.value);r.value=(e||[]).filter((e=>!!e.name&&"token"===e.type))}catch(e){}}()),Ve().getContractCheckResult(l,g.value)}}}));function qe(){const{t:e}=n(),l=Y(),a=L(),t=A(),r=o((()=>{var n,o,r,s;return(t.accessToken?[{id:"trade",name:e("mine")}]:[]).concat(null==(s=null==(r=null==(o=null==(n=l.totalHolders)?void 0:n.filter)?void 0:o.call(n,(e=>{var l;return((null==e?void 0:e.total_address)||0)>0&&(null==(l=["16","19","25","30","31"])?void 0:l.includes(e.type))})))?void 0:r.map)?void 0:s.call(r,(e=>({id:e.type,name:(null==e?void 0:e[O(a.locale)])+("31"!==e.type?`(${null==e?void 0:e.total_address})`:"")}))))})),s=W("tv_markTabsChecked",{trade:!0,16:!1,19:!1,25:!0,30:!1,31:!0});const i=new Map,u=new Map;function d({el:e,side:l,type:n,urlPrefix:o,name:a,bucketTime:t}){var r;const s="buy"===l,i="31"===n;let u=s?`${o}signals/marks/mark-buy-${n}.png`:`${o}signals/marks/mark-sell-${n}.png`;(null==(r=e.wallet_logo)?void 0:r.logo)&&e.wallet_logo.logo.includes(".webp")&&(u=e.wallet_logo.logo);let d="transparent",v=0;return i&&(v=2,d=s?"#12B886":"#F6465D"),{id:`${e.tx_time}-${l}-${n}`,time:t,color:{background:"transparent",border:d},imageUrl:u,label:s?"B":"S",labelFontColor:"#fff",minSize:Number(e.volume)>=2e3?30:25,hoveredBorderWidth:v,borderWidth:v,text:c(a,n,e,s,t),showLabelWhenImageLoaded:!1,user_address:e.wallet_address,tx_time:e.tx_time}}function c(l,n,o,a,t){var r;const s=e(a?"bought":"sold"),i=null==l?void 0:l.replace(/\(.*\)$/,"");if(30===Number(n)){const l=e(a?"netInflow":"netOutflow"),n=e(a?"inflow":"outflow"),r=e(a?"campaignBuyAvg":"campaignSellAvg");return`${i} ${l}\n        ${n}: ${q(o.volume,2)}(${q(o.txns,0)})\n        ${r}: $${q(Number(o.volume)/(Number(o.amount)||1),4)}\n        ${l}: ${q(o.volume,2)}\n        ${z(t,"YYYY-MM-DD HH:mm")}\n      `}return`${(null==(r=o.wallet_logo)?void 0:r.name)||`${i}`} ${s}\n        ${e("amountB")}: ${q(o.amount,2)}\n        ${e("amountU")}: $${q(o.volume,2)}\n        ${e("price")}: $${q(Number(o.volume)/(Number(o.amount)||1),4)}\n        ${e("Txs")}: ${q(o.txns)}\n        ${z(t,"YYYY-MM-DD HH:mm")}\n        `}function v(e,l,n,o){var a,t,r,s,i,u,d,c,v;const p=[],_={},h=(null==(a=U().globalConfig)?void 0:a.token_logo_url)||"https://www.iconaves.com/",b=Number(l);for(const m of e){const e=Math.floor(m.time/b)*b;if(30===Number(n)){const l=(null==(t=null==m?void 0:m.buy)?void 0:t.volume)||0,n=(null==(r=null==m?void 0:m.sell)?void 0:r.volume)||0,o=`${e}-${l>n?"buy":"sell"}`,a=_[o]??(_[o]={time:e,side:l>n?"buy":"sell",amount:0,txns:0,volume:0,buyAmount:0,sellAmount:0,buyTxns:0});a.buyAmount=(null==(s=null==m?void 0:m.buy)?void 0:s.amount)||0,a.sellAmount=(null==(i=null==m?void 0:m.sell)?void 0:i.amount)||0,a.amount=Math.abs(a.buyAmount-a.sellAmount),a.buyTxns=(null==(u=null==m?void 0:m.buy)?void 0:u.txns)||0,a.sellTxns=(null==(d=null==m?void 0:m.sell)?void 0:d.txns)||0,a.txns=a.buyTxns+a.sellTxns,a.volume=Math.abs(l-n),a.buyVolume=(null==(c=null==m?void 0:m.buy)?void 0:c.volume)||0,a.sellVolume=(null==(v=null==m?void 0:m.sell)?void 0:v.volume)||0}else{if(m.buy){const l=`${e}-buy`,n=_[l]??(_[l]={time:e,side:"buy",amount:0,txns:0,volume:0});n.amount+=m.buy.amount,n.txns+=m.buy.txns,n.volume+=m.buy.volume}if(m.sell){const l=`${e}-sell`,n=_[l]??(_[l]={time:e,side:"sell",amount:0,txns:0,volume:0});n.amount+=m.sell.amount,n.txns+=m.sell.txns,n.volume+=m.sell.volume}}}for(const f of Object.values(_)){const e="buy"===f.side;p.push({id:`${f.time}-${f.side}-${n}`,time:f.time,color:{background:"transparent",border:"transparent"},imageUrl:e?`${h}signals/marks/mark-buy-${n}.png`:`${h}signals/marks/mark-sell-${n}.png`,label:e?"B":"S",labelFontColor:"#fff",minSize:20,hoveredBorderWidth:0,borderWidth:0,text:m(f,n,o),showLabelWhenImageLoaded:!1})}return p.sort(((e,l)=>e.time-l.time))}function m(l,n,o){const a="buy"===l.side;if(30===Number(n)){const n=e(a?"netInflow":"netOutflow"),{buyVolume:t,sellVolume:r,buyTxns:s,sellTxns:i,volume:u}=l,d=(t||0)>0?`\n${e("inflow")}: ${q(t||0,2)}(${q(s||0,0)})\n${e("campaignBuyAvg")}: $${q((t||0)/(l.buyAmount||1),2)}`:"",c=(r||0)>0?`\n${e("outflow")}: $${q(r||0,4)}(${q(i||0,0)})\n${e("campaignSellAvg")}: $${q((r||0)/(l.sellAmount||1),2)}`:"";return`${null==o?void 0:o.replace(/\(.*\)$/,"")} ${n}${d}${c}\n${e(a?"netInflow":"netOutflow")}: ${q(u,2)}\n${z(l.time,"YYYY-MM-DD HH:mm")}\n`}const t=e(a?"bought":"sold"),{amount:r,txns:s,volume:i}=l;return`${null==o?void 0:o.replace(/\(.*\)$/,"")} ${t}\n${e("amountB")}: ${q(r,2)}\n${e("amountU")}: $${q(i,2)}\n${e("price")}: $${q(i/(r||1),4)}\n${e("Txs")}: ${q(s)}\n${z(l.time,"YYYY-MM-DD HH:mm")}\n`}return G((()=>{var e;return null==(e=l.token)?void 0:e.token}),(()=>{i.clear(),u.clear()})),{marksTabs:r,markTabsChecked:s,createMarkButton:function(e,l){var n;const o=null==e?void 0:e.createButton();o&&(null==(n=r.value)||n.forEach((l=>{var n;const a=document.createElement("button");a.style.display="flex",a.style.alignItems="center",a.style.cursor="pointer",a.style.backgroundColor="transparent",a.style.border="none",a.style.outline="none",a.style.fontSize="12px",(null==(n=s.value)?void 0:n[null==l?void 0:l.id])&&(a.style.color="#3F80F7"),a.innerText=l.name,o.appendChild(a),a.onclick=()=>{var n,o,t,r,i,u;s.value[l.id]?(s.value[l.id]=!1,a.style.color="inherit",null==(t=null==(o=null==(n=null==e?void 0:e.activeChart)?void 0:n.call(e))?void 0:o.clearMarks)||t.call(o)):(s.value[l.id]=!0,a.style.color="#3F80F7"),null==(u=null==(i=null==(r=null==e?void 0:e.activeChart)?void 0:r.call(e))?void 0:i.refreshMarks)||u.call(i)}})),l.push(o))},getMarks:function({from:e,to:l,interval:n,onDataCallback:o,pair:a,chain:t,token:c,user:m}){r.value.forEach((r=>{var p,_,h,b;const f=a+"-"+t+"-"+m+"-"+n+"-"+r.id+"-"+e+"-"+l;if(i.has(f)&&(null==(p=s.value)?void 0:p[r.id])){const e=v(i.get(f)||[],n,r.id,r.name);o(e||[])}else if(u.has(f)&&(null==(_=s.value)?void 0:_[r.id])){const e=u.get(f);o(e)}else"trade"===r.id&&(null==(h=s.value)?void 0:h[r.id])?H({from:e,to:l,interval:n,pair:a+"-"+t,token_address:c,user_address:m}).then((e=>{const l=v(e,n,r.id,r.name);i.set(f,e||[]),o(l||[])})):(null==(b=s.value)?void 0:b[r.id])&&V({from:e,to:l,interval:n,pair_id:a+"-"+t,type:r.id}).then((e=>{if(Array.isArray(e)){const l=function(e,l,n,o){var a;const t=[],r=(null==(a=U().globalConfig)?void 0:a.token_logo_url)||"https://www.iconaves.com/",s=Number(l);for(const i of e){const e=Math.floor(i.time/s)*s;for(const l of i.holders){const{wallet_address:a,wallet_logo:s}=l;l.buy&&t.push(d({el:{...l.buy,wallet_address:a,wallet_logo:s},side:"buy",type:n,name:o,bucketTime:e,urlPrefix:r})),l.sell&&t.push(d({el:{...l.sell,wallet_address:a,wallet_logo:s},side:"sell",type:n,name:o,bucketTime:e,urlPrefix:r}))}}return t}(e||[],n,r.id,r.name);u.set(f,l),o(l||[])}}))}))},wsTxUpdateMarks:function({tx:e,interval:n,user:o},a){var t,r,s,u,d,c;const v=null==(t=null==l?void 0:l.token)?void 0:t.token,m=null==(r=null==l?void 0:l.token)?void 0:r.chain,p=null==l?void 0:l.pairAddress,_={time:e.time};if("maker"in e){if(v!==e.target||e.maker!==o)return;const l=e.direction;"buy"===l&&(_.buy={amount:Number((null==e?void 0:e.target_amt)||0),txns:1,volume:Number((null==e?void 0:e.price_u)||0)*Number((null==e?void 0:e.target_amt)||0)}),"sell"===l&&(_.sell={amount:Number((null==e?void 0:e.target_amt)||0),txns:1,volume:Number((null==e?void 0:e.price_u)||0)*Number((null==e?void 0:e.target_amt)||0)})}else{if(v!==e.from_address&&v!==e.to_address||e.wallet_address!==o)return;const n=(null==(s=null==l?void 0:l.token)?void 0:s.token)===e.to_address?"buy":"sell";e.time,"buy"===n&&(Number((null==e?void 0:e.to_amount)||0),Number((null==e?void 0:e.to_price_usd)||0),Number((null==e?void 0:e.to_amount)||0)),"sell"===n&&(Number((null==e?void 0:e.from_amount)||0),Number((null==e?void 0:e.from_price_usd)||0),Number((null==e?void 0:e.from_amount)||0))}i.forEach(((e,l)=>{l.startsWith(p+"-"+m+"-"+o+"-"+n+"-trade")&&e.push(_)})),null==(c=null==(d=null==(u=null==a?void 0:a.activeChart)?void 0:u.call(a))?void 0:d.refreshMarks)||c.call(d)},profilingMarksCache:u}}const ze={key:0,class:"time"},je={key:0,class:"text-center"},Ke={class:"color-[--d-F5F5F5-l-111] text-14px mb-12px block"},Je={class:"color-[--d-F5F5F5-l-111] text-28px flex items-center"},Xe={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},Qe={class:""},Ze={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},el={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},ll={class:"bg-[--d-151A22-l-E8F1FF] px-16px py-8px radius-8px mr-6px text-center"},nl={key:1,class:"flex items-center bg-[--d-151A22-l-E8F1FF] py-8px px-24px radius-4px"},ol={class:"color-[--d-8CA0C3-l-566275] text-36px"},al=j({__name:"unknownRisk",props:{isRank:{type:Boolean,default:!1}},emits:["refresh"],setup(e,{emit:l}){const n=l,a=e.isRank?Ue():Y(),s=o((()=>a.price)),c=o((()=>{var e;return(null==(e=a.token)?void 0:e.opening_at)||0}));function p(){n("refresh")}return(e,l)=>{const n=K;return i(s)?m("",!0):(r(),v("div",ze,[i(c)>0?(r(),v("div",je,[d("span",Ke,w(e.$t("countdown2Opening")),1),(r(),t(n,{key:i(c),timestamp:i(c),"end-time":0,onDone:p},{default:u((({formattedData:e})=>[d("div",Je,[d("div",Xe,[d("span",Qe,w((e.days<10?"0":"")+e.days),1),l[0]||(l[0]=d("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"D",-1))]),d("div",Ze,[d("span",null,w((e.hours<10?"0":"")+e.hours),1),l[1]||(l[1]=d("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"H",-1))]),d("div",el,[d("span",null,w((e.minutes<10?"0":"")+e.minutes),1),l[2]||(l[2]=d("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"M",-1))]),d("div",ll,[d("span",null,w((e.seconds<10?"0":"")+e.seconds),1),l[3]||(l[3]=d("span",{class:"text-12px mt-4px color-[--d-8CA0C3-l-566275] block"},"S",-1))])])])),_:1},8,["timestamp"]))])):(r(),v("div",nl,[d("span",ol,w(e.$t("unknownRisk")),1)]))]))}}},[["__scopeId","data-v-64d3a44b"]]),tl={id:"tv_chart_container",ref:"kline",style:{width:"100%",height:"100%"}},rl=j(e({__name:"index",props:{isRank:{type:Boolean}},emits:["refresh"],setup(e,{emit:n}){const a=e,t=J(Re.KLINE_DATE_FILTER),s=a.isRank?Ue():Y(),u=A(),b=X(),f=Q(),k=Z(),g=o((()=>{var e;return a.isRank&&"klineRow"in s?null==(e=s.klineRow)?void 0:e.id:k.params.id})),y=l(""),x=l(!1);let w=!1,$=!1;const C=o((()=>{var e,l;return(null==(e=ee(g.value))?void 0:e.chain)||(null==(l=null==s?void 0:s.token)?void 0:l.chain)||""})),S=o((()=>{var e,l;return(null==(e=ee(g.value))?void 0:e.address)||(null==(l=null==s?void 0:s.token)?void 0:l.token)})),P=o((()=>{var e,l,n,o,a;return(null==(o=null==(n=null==(l=null==(e=u.userInfo)?void 0:e.addresses)?void 0:l.find)?void 0:n.call(l,(e=>e.chain===C.value)))?void 0:o.address)||(null==(a=null==u?void 0:u.userInfo)?void 0:a.evmAddress)})),F=o((()=>{var e;return(null==(e=null==s?void 0:s.token)?void 0:e.symbol)||"-"})),M=o((()=>null==s?void 0:s.pairAddress)),D=o((()=>{var e;return(null==(e=null==s?void 0:s.pair)?void 0:e.amm)||""}));let I=!1;G((()=>g.value),(e=>{var l,n;e&&(null==j?void 0:j.activeChart())&&(null==(n=null==(l=null==j?void 0:j.activeChart())?void 0:l.removeAllShapes)||n.call(l))})),G(M,(e=>{e!==y.value&&function(){var e,l,n,o,a;w=!1,rl(),il();const t=M.value;if(x.value&&"token-id"===k.name){const r=C.value&&oe.includes(C.value)||!1;V.value=ae(V.value,C.value,r),j?(null==(e=null==j?void 0:j.resetCache)||e.call(j),null==(o=null==(n=null==(l=null==j?void 0:j.activeChart)?void 0:l.call(j))?void 0:n.clearMarks)||o.call(n),null==(a=null==j?void 0:j.setSymbol)||a.call(j,F.value+"---"+g.value+t,V.value,(()=>{w=!0}))):Je()}}()})),G(P,(()=>{var e,l,n,o,a,t;x.value&&"token-id"===k.name&&(null==(n=null==(l=null==(e=null==j?void 0:j.activeChart)?void 0:e.call(j))?void 0:l.clearMarks)||n.call(l),null==(t=null==(a=null==(o=null==j?void 0:j.activeChart)?void 0:o.call(j))?void 0:a.refreshMarks)||t.call(a))}));const B=te(),R=L();let E=null,O=0;const H=new Map,V=N(localStorage.getItem("tv_resolution")||"15"),z=re();let j=null;const K=W("tv_showMarket",!1);function Ye(){var e;w=!1,$=!1,E=null,O=0,rl(),il(),null==(e=null==j?void 0:j.remove)||e.call(j),Je()}G((()=>z.theme),(e=>{j&&(null==j||j.changeTheme(e).then((()=>{var e;ul(),null==(e=null==j?void 0:j.applyOverrides)||e.call(j,{"scalesProperties.textColor":z.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":be("--secondary-bg")})})))})),G((()=>R.locale),(()=>{Ye()}));let Le=[];function Oe(){$&&(Le.forEach((e=>{var l;null==(l=null==j?void 0:j.removeButton)||l.call(j,e)})),Le=[],function(){const e=null==j?void 0:j.createButton();if(!e)return;const l=()=>{const l=K.value;e.innerHTML=`\n        <span style="font-size: 12px; cursor: pointer;">\n          ${l?'Price / <span style="color:#286DFF">MCap</span>':'<span style="color:#286DFF">Price</span> / MCap'}\n        </span>`};e.onclick=()=>{var e,n,o,a;K.value=!K.value,l(),null==(e=null==j?void 0:j.resetCache)||e.call(j),null==(a=null==(n=null==j?void 0:j.activeChart)?void 0:(o=n.call(j)).resetData)||a.call(o)},l(),Le.push(e)}(),We(j,Le))}const{createMarkButton:We,getMarks:Ge,marksTabs:He,wsTxUpdateMarks:Ve,profilingMarksCache:ze}=qe();G(He,(()=>{x.value&&Oe()}));let je=!1,Ke=0;async function Je(){var e,l,n;const o=(null==(l=null==(e=F.value)?void 0:e.toUpperCase)?void 0:l.call(e))||"-",a=C.value&&oe.includes(C.value)||!1;V.value=ae(V.value,C.value,a);const r=(null==(n=U().globalConfig)?void 0:n.token_logo_url)||"https://www.iconaves.com/",i=await se();j=new i({symbol:o.replace("<","＜")||" ",debug:!1,width:"100%",height:"100%",interval:V.value,theme:z.theme,container:"tv_chart_container",library_path:`${r}charting_library-29.4.0/charting_library/`,locale:ue(R.locale),disabled_features:["header_symbol_search","header_screenshot","header_compare","volume_force_overlay","header_undo_redo","header_settings","header_saveload","timeframes_toolbar"],enabled_features:["request_only_visible_range_on_reset",...a?["seconds_resolution"]:[]],charts_storage_url:location.host,charts_storage_api_version:"1.1",timezone:ie(),time_frames:[],loading_screen:{backgroundColor:z.isDark?"#0B0D12":"#F6F9FF",foregroundColor:"#3F80F7"},custom_css_url:`${location.origin}/tv_custom_1.css`,custom_formatters:{priceFormatterFactory:()=>({format:e=>K.value?q(e,{decimals:2,locale:"en"}):String(q(e,{decimals:4,limit:6,locale:"en"}))})},overrides:{volumePaneSize:"small","paneProperties.topMargin":"10","scalesProperties.textColor":z.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":z.isDark?"#0B0D12":"#F6F9FF","paneProperties.vertGridProperties.style":2,"paneProperties.legendProperties.showLegend":!1,"paneProperties.legendProperties.showStudyArguments":!0,"paneProperties.legendProperties.showStudyTitles":!0,"paneProperties.legendProperties.showStudyValues":!0,"paneProperties.legendProperties.showSeriesTitle":!0,"paneProperties.legendProperties.showSeriesOHLC":!0,"mainSeriesProperties.candleStyle.drawWick":!0,"mainSeriesProperties.candleStyle.drawBorder":!0,"mainSeriesProperties.candleStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.hollowCandleStyle.drawWick":!0,"mainSeriesProperties.hollowCandleStyle.drawBorder":!0,"mainSeriesProperties.haStyle.drawWick":!0,"mainSeriesProperties.haStyle.drawBorder":!0,"mainSeriesProperties.haStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.barStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.barStyle.dontDrawOpen":!1,"mainSeriesProperties.lineStyle.linewidth":2,"mainSeriesProperties.lineStyle.priceSource":"close","mainSeriesProperties.areaStyle.linewidth":2,"mainSeriesProperties.areaStyle.priceSource":"close"},datafeed:{onReady:e=>{const l=C.value&&oe.includes(C.value),n={supported_resolutions:["1S","1","5","15","30","60","120","240","1D","1W"],supports_marks:!0,supports_timescale_marks:!0,supports_time:!0};l||(n.supported_resolutions=["1","5","15","30","60","120","240","1D","1W"]),ul(),setTimeout((()=>e(n)),50)},resolveSymbol:(e,l,n)=>{var o,a,t,r,i,u,d,c,v,m;try{const e=!(!C.value||!(null==(a=null==(o=oe)?void 0:o.includes)?void 0:a.call(o,C.value))),n=(null==(r=null==(t=F.value)?void 0:t.toUpperCase)?void 0:r.call(t))||(null==(i=null==s?void 0:s.token)?void 0:i.symbol)||"-",m=Number(null==s?void 0:s.price)||0,p={name:n,ticker:n,description:(null==(d=null==(u=null==n?void 0:n.split)?void 0:u.call(n,"---"))?void 0:d[0])||"",exchange:"Ave.ai",timezone:ie(),format:K.value?"volume":"price",minmov:1,minmove2:0,pricescale:m>0?10**pe(m).precision:1e10,volume_precision:2,fractional:!1,session:"24x7",has_intraday:!0,intraday_multipliers:["1","5","15","30","60","120","240"],has_seconds:e,seconds_multipliers:["1","5","15","30"],has_daily:!0,has_weekly_and_monthly:!0,supported_resolutions:["1S","1","5","15","30","60","120","240","1D","1W"],data_status:"streaming",visible_plots_set:"ohlcv",type:"crypto",listed_exchange:(null==(v=null==(c=me)?void 0:c(C.value||"",D.value))?void 0:v.show_name)||""};e||(p.supported_resolutions=["1","5","15","30","60","120","240","1D","1W"],p.seconds_multipliers=[]),setTimeout((()=>l(p)),0)}catch(p){n((null==(m=null==p?void 0:p.toString)?void 0:m.call(p))||"resolveSymbol err")}},getBars:(e,l,n,o,a)=>{var t;const{from:r,to:i,firstDataRequest:u}=n;try{if(u)je=!1,E=null,O=0;else if(je)return void o([],{noData:!0});const e={interval:de(l),pair_id:M.value+"-"+C.value,token_id:M.value?void 0:g.value,from:r,to:u?0:Math.max(i,Ke||0)};I=!0,ce(e).then((e=>{var l,n;const a=(null==e?void 0:e.kline_data)||[],t=(null==(l=null==a?void 0:a.map)?void 0:l.call(a,(e=>({time:1e3*e.time,open:K.value?new T(e.open||0).times((null==s?void 0:s.circulation)||0).toNumber():e.open,high:K.value?new T(e.high||0).times((null==s?void 0:s.circulation)||0).toNumber():e.high,low:K.value?new T(e.low||0).times((null==s?void 0:s.circulation)||0).toNumber():e.low,close:K.value?new T(e.close||0).times((null==s?void 0:s.circulation)||0).toNumber():e.close,volume:e.volume}))))||[];y.value=(null==e?void 0:e.pair)||"",u&&(E=(null==a?void 0:a[(null==a?void 0:a.length)-1])||null,O=Number((null==E?void 0:E.close)||0),E&&(E.time=1e3*E.time),je=(null==t?void 0:t.length)<100),(null==a?void 0:a.length)>0&&(Ke=(null==(n=null==a?void 0:a[0])?void 0:n.time)||0),o(t,{noData:!(null==t?void 0:t.length)}),setTimeout((()=>{ve("klineDataReady").emit()}),10)})).finally((()=>{I=!1}))}catch(d){a((null==(t=null==d?void 0:d.toString)?void 0:t.call(d))||"getBars err")}},subscribeBars:(e,l,n,o)=>{if(H.has(g.value))return void Qe(l,n);const{address:a,chain:t}=ee(g.value);let r=["multi_tx",a,t];Ie.includes(t)&&(r=["simple_tx",{tks:[{ch:t,tk:a}],rt:"json"}]);const s={jsonrpc:"2.0",method:"subscribe",params:r,id:1};Qe(l,n,B.send(s)),H.set(g.value,s)},unsubscribeBars:e=>{var l;if(e){const e=H.get(g.value)||{};if((null==(l=null==e?void 0:e.params)?void 0:l[1])===S.value)return;H.forEach((e=>{var l;(null==(l=null==e?void 0:e.params)?void 0:l[1])!==S.value&&B.send({...e,method:"unsubscribe"})})),null==H||H.clear()}},searchSymbols:(e,l,n,o)=>{},getMarks:(e,l,n,o,a)=>{const t=de(a);Ge({from:l,to:n,interval:t,pair:M.value,token:g.value,chain:C.value||"",user:P.value,onDataCallback:o})}}}),_e(),j.onChartReady((()=>{var e,l,n,o,a;x.value=!0,w=!0,z.isDark?null==(e=null==j?void 0:j.applyOverrides)||e.call(j,{"scalesProperties.textColor":"#d5d5d5"}):null==(l=null==j?void 0:j.applyOverrides)||l.call(j,{"scalesProperties.textColor":"#333"}),null==(o=null==(n=null==j?void 0:j.activeChart)?void 0:n.call(j))||o.onIntervalChanged().subscribe(null,(e=>{var l;V.value!==e&&(V.value=e,localStorage.setItem("tv_resolution",e),null==(l=null==j?void 0:j.resetCache)||l.call(j))})),he(j),sl(),function(){if(null==j?void 0:j.activeChart){let e=JSON.parse((null==localStorage?void 0:localStorage[De])||"[]");e=e.filter(((l,n)=>e.findIndex((e=>e.name===l.name))===n)),e.forEach((e=>{var l;null==(l=null==j?void 0:j.activeChart)||l.call(j).createStudy(e.name,!1,!1)}))}}(),null==(a=null==j?void 0:j.applyOverrides)||a.call(j,{"scalesProperties.textColor":z.isDark?"#d5d5d5":"#333","paneProperties.backgroundType":"solid","paneProperties.background":be("--secondary-bg")})})),null==j||j.headerReady().then((()=>{$=!0,Oe()})),null==j||j.subscribe("onMarkClick",(e=>{var l,n;const{token:o,symbol:a,logo_url:t,chain:r}=(null==(l=s.tokenInfo)?void 0:l.token)||{},{target_token:i,token0_address:u,token0_symbol:d,token1_symbol:c,pair:v}=s.pair||{};let m=P.value;for(const[,s]of ze){const l=null==(n=s.find((l=>l.id===e)))?void 0:n.user_address;if(l){m=l;break}}const p={drawerVisible:!0,tokenInfo:{id:k.params.id,symbol:a,logo_url:t,chain:r,address:o},pairInfo:{target_token:i,token0_address:u,token0_symbol:d,token1_symbol:c,pairAddress:v},user_address:m};b.$patch(p)}));let u=0;j.subscribe("mouse_down",(()=>{u=performance.now()})),j.subscribe("mouse_up",(e=>{if(performance.now()-u>=200)return;const l=null==j?void 0:j.activeChart().getTimeScale().coordinateToTime(e.clientX-56);if(l&&V.value){const e=fe[V.value]||{val:V.value,unit:"m"},n=ke(1e3*l).add(e.val,e.unit).unix();f.isClickKlineFilter&&(null==t?void 0:t.value)&&(t.value=[String(l),String(n)])}})),null==j||j.subscribe("study_event",((e,l)=>{"create"!==l&&"remove"!==l||Xe||function(){var e;if(null==j?void 0:j.activeChart){let l=(null==(e=null==j?void 0:j.activeChart)?void 0:e.call(j).getAllStudies())||[];l=l.filter(((e,n)=>l.findIndex((l=>l.name===e.name))===n)),localStorage.setItem(De,JSON.stringify(l.filter((e=>"Volume"!==e.name))))}}()})),window.onbeforeunload=()=>{Xe=!0}}let Xe=!1;function Qe(e,l,n=B.getWSInstance()){null==n||n.onmessage((n=>{var o,a,t,r,i,u;const d=ge(n);if(!d)return;const{event:c,data:v}=d;if(c===ye.SIMPLE_TX||c===ye.TX){const n=(null==v?void 0:v.msg)||(null==v?void 0:v.tx),d=de(e),c=null==(o=ee(g.value))?void 0:o.address;let m="";if(m="target"in n?n.target:[n.from_address,n.to_address].find((e=>e===c))||"",m===c&&!I){const e="pair"in n?n.pair:n.pair_address,o="price_u"in n?Number(n.price_u||0):Number((null==(t=null==(a=n.from_address)?void 0:a.toLowerCase)?void 0:t.call(a))===(null==(u=null==(i=null==(r=s.token)?void 0:r.token)?void 0:i.toLowerCase)?void 0:u.call(i))?n.from_price_usd:n.to_price_usd)||0;if(e===M.value&&(O=o),e!==M.value){const e=o;if(!O&&Math.abs(e-O)>.35*O)return}s.tokenPrice=o;const v=xe(n,c,E,d);v&&(E={...v});const m={...v};K.value&&m&&(m.open=new T(m.open||0).times((null==s?void 0:s.circulation)||0).toNumber(),m.high=new T(m.high||0).times((null==s?void 0:s.circulation)||0).toNumber(),m.low=new T(m.low||0).times((null==s?void 0:s.circulation)||0).toNumber(),m.close=new T(m.close||0).times((null==s?void 0:s.circulation)||0).toNumber()),m&&(null==m?void 0:m.time)&&l(m)}Ve({tx:n,interval:Number(d),user:P.value},j)}}),"kline")}let Ze=!1;const el=we("kHeight",$e.KLINE),ll=Ce().height,nl=Se("kline");function ol(e){let l=e.clientY;if(Ze=!0,!nl)return;const{height:n}=Be(nl);return el.value=n.value,document.onmousemove=e=>{if(!Ze)return;if(e.clientY>ll.value)return void(Ze=!1);document.getElementById("tv_chart_container").style.pointerEvents="none";const n=e.clientY<l?el.value-(l-e.clientY):el.value+e.clientY-l;n<=ll.value-164&&(el.value=n),l=e.clientY},document.onmouseup=()=>{document.getElementById("tv_chart_container").style.pointerEvents="auto",Ze=!1,document.onmousemove=null,document.onmouseup=null,s.centerTopHeight=el.value},!1}const{resetLimitPriceLineId:rl,subscribePriceMove:sl}=le((()=>j),(()=>w),K),{resetAvgPriceLineId:il}=ne((()=>j),(()=>w),K);function ul(){var e;const l=document.querySelector("#tv_chart_container iframe"),n=null==(e=null==l?void 0:l.contentWindow)?void 0:e.document.documentElement;n&&n.style.setProperty("--secondary-bg",be("--secondary-bg"))}Pe((()=>j),(()=>w),K),Fe((()=>{Xe=!0})),Ne((()=>{Je(),Ee((()=>{var e,l,n,o;null==(e=null==j?void 0:j.resetCache)||e.call(j),null==(o=null==(l=null==j?void 0:j.activeChart)?void 0:(n=l.call(j)).resetData)||o.call(n)}))}));const dl=n;function cl(){dl("refresh"),Ye()}return(e,l)=>(r(),v(_,null,[d("div",{class:"relative",style:Me({height:`${e.isRank?390:i(el)}px`})},[d("div",tl,null,512),Ae(p(al,{isRank:e.isRank,onRefresh:cl},null,8,["isRank"]),[[Te,i(x)]])],4),e.isRank?m("",!0):(r(),v("div",{key:0,class:"w-full cursor-row-resize bg-[--border] gap-1px hover:bg-[--third-text] flex items-center justify-center h-4px",onMousedown:c(ol,["stop","prevent"])},[(r(),v(_,null,h(4,(e=>d("span",{key:e,class:"bg-[--icon-color] w-2px h-2px rounded-full"}))),64))],32))],64))}}),[["__scopeId","data-v-fda894ae"]]);export{rl as K,Le as _,Ve as a,Ge as b,Oe as c,We as d,He as g,Ue as u};
